<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>部门内训 · 技术推广部</title>
    <link rel="icon" href="image/jt.jpg">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;600;700&family=Noto+Sans+SC:wght@300;400;700&display=swap" rel="stylesheet">
    <style>
    :root{ --bg:#0b1220; --surface:#121a2b; --text:#e6edf3; --muted:#9aa7b2; --accent:#6a5af9; --overlay-bg: rgba(18,26,43,.7); }
    body.dark-mode{ --bg:#f4f7fc; --surface:#ffffff; --text:#2c3e50; --muted:#6b7280; --accent:#ff9800; --overlay-bg: rgba(255,255,255,.85); }
    *{ box-sizing:border-box; }
    html,body{ height:100%; margin:0; }
    body{ font-family:'Poppins','Noto Sans SC',sans-serif; color:var(--text); background:linear-gradient(180deg,#0b1220 0%, #0e1627 100%); }
    a{ color:var(--accent); text-decoration:none; }
    a:hover{ text-decoration:underline; }
    .header-bar{ position:fixed; inset:0 0 auto 0; height:56px; display:flex; align-items:center; justify-content:center; padding:0 16px; background:var(--overlay-bg); backdrop-filter:blur(8px); z-index:10; box-shadow:0 2px 10px rgba(0,0,0,.25); }
    .header-bar a{ color:var(--accent); font-weight:700; }
    .title{ margin:0; font-weight:700; text-align:center; }
    .header-bar .back{ position:absolute; left:16px; top:50%; transform:translateY(-50%); }
    .header-bar #theme-toggle{ position:absolute; right:16px; top:50%; transform:translateY(-50%); color:var(--accent); cursor:pointer; }
    .stage{ position:relative; height:100svh; padding-top:56px; overflow:hidden; }
    .slide{ position:absolute; inset:0 0 0 0; display:flex; align-items:center; justify-content:center; opacity:0; transition:opacity .4s ease; }
    .slide.active{ opacity:1; }
    .slide img{ width:100vw; height:calc(100svh - 56px); object-fit:cover; object-position:center; }
    .arrow{ position:absolute; top:50%; transform:translateY(-50%); border:none; background:transparent; color:var(--text); display:flex; align-items:center; justify-content:center; cursor:pointer; z-index:5; padding:0; }
    .arrow i{ font-size:56px; line-height:1; }
    .arrow:hover{ color:var(--accent); }
    .arrow.left{ left:16px; }
    .arrow.right{ right:16px; }
    .caption{ position:absolute; left:16px; bottom:16px; background:var(--overlay-bg); padding:12px 14px; border-radius:10px; box-shadow:0 4px 16px rgba(0,0,0,.25); max-width:min(92vw, 760px); }
    .caption h3{ margin:0 0 6px 0; font-size:1.1rem; }
    .caption p{ margin:0; color:var(--muted); }
    .ppt{ display:inline-flex; align-items:center; gap:8px; font-weight:700; margin-left:8px; }
    .dots{ position:absolute; left:50%; transform:translateX(-50%); bottom:18px; display:flex; gap:10px; z-index:5; }
    .dot{ width:8px; height:8px; border-radius:50%; background:rgba(255,255,255,.35); cursor:pointer; }
    .dot.active{ background:var(--accent); }
    @media (max-width: 768px){ .caption{ left:12px; right:12px; max-width:unset; } .slide img{ height:calc(100svh - 56px); } }
    
    /* 粒子背景效果 */
    .particles {
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        pointer-events: none;
        z-index: -1;
    }
    
    .particle {
        position: absolute;
        border-radius: 50%;
        animation: float 15s infinite linear;
        pointer-events: auto; /* 允许交互 */
    }
    
    @keyframes float {
        0% {
            transform: translateY(0) translateX(0) rotate(0deg);
            opacity: 0;
        }
        10% {
            opacity: 1;
        }
        90% {
            opacity: 1;
        }
        100% {
            transform: translateY(-100vh) translateX(100px) rotate(360deg);
            opacity: 0;
        }
    }
    
    /* 渐变背景动画 */
    body {
        font-family: 'Poppins', 'Noto Sans SC', sans-serif; 
        color: var(--text); 
        background: linear-gradient(180deg, #0b1220 0%, #0e1627 100%);
        background-size: 400% 400%;
        animation: gradientShift 15s ease infinite;
    }
    
    @keyframes gradientShift {
        0% {
            background-position: 0% 50%;
        }
        50% {
            background-position: 100% 50%;
        }
        100% {
            background-position: 0% 50%;
        }
    }
    
    /* 幻灯片标题动画 */
    .caption h3 {
        margin: 0 0 6px 0; 
        font-size: 1.1rem;
        animation: fadeInUp 0.6s ease-out forwards;
        opacity: 0;
    }
    
    .caption p {
        margin: 0; 
        color: var(--muted);
        animation: fadeInUp 0.6s ease-out 0.2s forwards;
        opacity: 0;
    }
    
    @keyframes fadeInUp {
        from {
            opacity: 0;
            transform: translateY(20px);
        }
        to {
            opacity: 1;
            transform: translateY(0);
        }
    }
    
    /* 进度条 */
    .scroll-progress {
        position: fixed;
        top: 0;
        left: 0;
        width: 0%;
        height: 4px;
        background: linear-gradient(90deg, #6a5af9, #00aaff);
        z-index: 1001;
        transition: width 0.3s ease;
    }
    </style>
</head>
<body>
    <!-- 进度条 -->
    <div class="scroll-progress" id="scroll-progress"></div>
    
    <!-- 粒子背景 -->
    <div class="particles" id="particles"></div>
    
    <header class="header-bar">
        <a class="back" href="dep_home.html" aria-label="返回部门主页"><i class="fas fa-arrow-left"></i></a>
        <span class="title">部门内训</span>
        <i id="theme-toggle" class="fas fa-drumstick-bite" title="切换浅/深色模式"></i>
    </header>

    <main class="stage" aria-live="polite">
        <button class="arrow left" id="prev" aria-label="上一张"><i class="fas fa-angle-left"></i></button>
        <button class="arrow right" id="next" aria-label="下一张"><i class="fas fa-angle-right"></i></button>

        <!-- Slide 1: Markdown -->
        <section class="slide active" data-index="0">
            <img src="https://placehold.co/1600x900/6a5af9/ffffff?text=Markdown+Workshop" alt="Markdown Workshop 图示">
            <div class="caption">
                <h3>Markdown 基础与最佳实践</h3>
                <p>快速掌握常用语法、组织规范与协作写作。<a class="ppt" href="projects/example.pdf" target="_blank" rel="noopener"><i class="fas fa-file-powerpoint"></i> PPT</a></p>
            </div>
        </section>

        <!-- Slide 2: LaTeX -->
        <section class="slide" data-index="1">
            <img src="https://placehold.co/1600x900/00aaff/ffffff?text=LaTeX+Training" alt="LaTeX Training 图示">
            <div class="caption">
                <h3>LaTeX 科研写作与排版</h3>
                <p>数学公式、参考文献与图表排版的专业入门。<a class="ppt" href="projects/example.pdf" target="_blank" rel="noopener"><i class="fas fa-file-powerpoint"></i> PPT</a></p>
            </div>
        </section>

        <!-- Slide 3: Python Visualization -->
        <section class="slide" data-index="2">
            <img src="https://placehold.co/1600x900/28a745/ffffff?text=Python+Visualization" alt="Python Visualization 图示">
            <div class="caption">
                <h3>Python 可视化实战</h3>
                <p>用 Matplotlib / Seaborn / Plotly 构建高质量图表。<a class="ppt" href="projects/example.pdf" target="_blank" rel="noopener"><i class="fas fa-file-powerpoint"></i> PPT</a></p>
            </div>
        </section>

        <div class="dots" role="tablist" aria-label="幻灯片进度">
            <span class="dot active" data-go="0" role="tab" aria-selected="true" aria-controls="slide-1"></span>
            <span class="dot" data-go="1" role="tab" aria-selected="false" aria-controls="slide-2"></span>
            <span class="dot" data-go="2" role="tab" aria-selected="false" aria-controls="slide-3"></span>
        </div>
    </main>

    <script>
    (function(){
      const slides = Array.from(document.querySelectorAll('.slide'));
      const dots = Array.from(document.querySelectorAll('.dot'));
      const prev = document.getElementById('prev');
      const next = document.getElementById('next');
      let index = 0;

      function show(i){
        index = (i + slides.length) % slides.length;
        slides.forEach((s,idx)=> s.classList.toggle('active', idx===index));
        dots.forEach((d,idx)=> d.classList.toggle('active', idx===index));
        
        // 为新激活的幻灯片触发动画
        const activeSlide = slides.find(s => s.classList.contains('active'));
        if (activeSlide) {
            const caption = activeSlide.querySelector('.caption');
            if (caption) {
                // 重置动画
                const h3 = caption.querySelector('h3');
                const p = caption.querySelector('p');
                if (h3) h3.style.animation = 'none';
                if (p) p.style.animation = 'none';
                
                // 触发动画
                setTimeout(() => {
                    if (h3) h3.style.animation = 'fadeInUp 0.6s ease-out forwards';
                    if (p) p.style.animation = 'fadeInUp 0.6s ease-out 0.2s forwards';
                }, 10);
            }
        }
      }
      prev.addEventListener('click', ()=> show(index-1));
      next.addEventListener('click', ()=> show(index+1));
      dots.forEach(d=> d.addEventListener('click', ()=> show(parseInt(d.dataset.go,10))));

      // 键盘支持
      document.addEventListener('keydown', (e)=>{
        if(e.key==='ArrowLeft') show(index-1);
        if(e.key==='ArrowRight') show(index+1);
      });

      // 明暗主题开关
      const themeToggle = document.getElementById('theme-toggle');
      if(themeToggle){ themeToggle.addEventListener('click', ()=> document.body.classList.toggle('dark-mode')); }
      
      // 创建粒子效果
      function createParticles() {
          const particlesContainer = document.getElementById('particles');
          const particleCount = 50; // 增加粒子数量
          
          for (let i = 0; i < particleCount; i++) {
              const particle = document.createElement('div');
              particle.classList.add('particle');
              
              // 随机位置和动画延迟
              const size = Math.random() * 10 + 5; // 增大粒子尺寸
              particle.style.width = `${size}px`;
              particle.style.height = `${size}px`;
              particle.style.left = `${Math.random() * 100}%`;
              particle.style.top = `${Math.random() * 100}%`;
              particle.style.animationDelay = `${Math.random() * 15}s`;
              particle.style.animationDuration = `${Math.random() * 15 + 10}s`;
              
              // 使用多种颜色
              const colors = [
                  `rgba(106, 90, 249, ${Math.random() * 0.7 + 0.3})`,  // 紫色
                  `rgba(0, 170, 255, ${Math.random() * 0.7 + 0.3})`,    // 蓝色
                  `rgba(255, 152, 0, ${Math.random() * 0.7 + 0.3})`,    // 橙色
                  `rgba(124, 77, 255, ${Math.random() * 0.7 + 0.3})`    // 深紫
              ];
              particle.style.backgroundColor = colors[Math.floor(Math.random() * colors.length)];
              
              // 添加交互效果
              particle.addEventListener('mouseover', function() {
                  this.style.transform = 'scale(2)';
                  this.style.transition = 'transform 0.3s ease';
              });
              
              particle.addEventListener('mouseout', function() {
                  this.style.transform = 'scale(1)';
              });
              
              particlesContainer.appendChild(particle);
          }
      }
      
      // 滚动进度条
      function updateScrollProgress() {
          const scrollTop = window.scrollY;
          const docHeight = document.body.scrollHeight - window.innerHeight;
          const scrollPercent = (scrollTop / docHeight) * 100;
          document.getElementById('scroll-progress').style.width = `${scrollPercent}%`;
      }
      
      // 鼠标移动视差效果
      function parallaxParticles(e) {
          const particles = document.querySelectorAll('.particle');
          const x = e.clientX / window.innerWidth;
          const y = e.clientY / window.innerHeight;
          
          particles.forEach(particle => {
              const speed = parseFloat(particle.style.animationDuration) / 20;
              const xPos = (x - 0.5) * speed;
              const yPos = (y - 0.5) * speed;
              
              particle.style.transform = `translate(${xPos}px, ${yPos}px)`;
          });
      }
      
      // 初始化
      document.addEventListener('DOMContentLoaded', function() {
          createParticles();
          window.addEventListener('scroll', updateScrollProgress);
          document.addEventListener('mousemove', parallaxParticles);
      });
    })();
    </script>
</body>
</html>

